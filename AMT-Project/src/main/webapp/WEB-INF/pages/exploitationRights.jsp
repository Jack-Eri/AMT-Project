<%--
  Created by IntelliJ IDEA.
  User: andresmoreno
  Date: 07.11.19
  Time: 09:28
  To change this template use File | Settings | File Templates.
--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@taglib prefix="t" tagdir="/WEB-INF/tags" %>

<t:layout>
    <jsp:attribute name="header">
        <title>Exploitation Rights</title>
    </jsp:attribute>
    <jsp:body>
        <c:if test="${not empty success}">
            <p class="alert alert-success">${success}</p>
        </c:if>
        <c:if test="${not empty error}">
            <p class="alert alert-danger">${error}</p>
        </c:if>
        <div class="container margin-top">
            <p>Create a new exploitation right</p>
            <form action="rights?page=${page}&amount=${amount}" method="post">
                <input type="text" name="username" placeholder="Farmer Username"/>
                <input type="number" name="idField" placeholder="Field ID"/>
                <br/>
                <input type="date" name="issueDate" placeholder="Issue Date"/>
                <input type="number" name="duration" placeholder="Duration"/>
                <input type="number" name="monthlyFee" placeholder="Monthly Fee"/>
                <br/>
                <button type="submit" class="btn btn-primary" name="create">create</button>
            </form>
        </div>
        <div class="container margin-top">
            <c:if test="${not empty rights}">
                <p>Displaying ${rights.size()} results</p>
            </c:if>
            <table id="example" class="table text-center" style="width:100%">
                <thead>
                <tr>
                    <th>Farmer</th>
                    <th>Field ID</th>
                    <th>Field Size</th>
                    <th>Issue Date</th>
                    <th>Duration</th>
                    <th>Monthly Fee</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                <c:choose>
                    <c:when test="${!rights.isEmpty()}">
                        <c:forEach items="${rights}" var="right">
                            <tr>
                                <form action="rights?page=${page}" method="post">
                                    <input type="hidden" name="idFarmer" value="${right.farmer.idFarmer}"/>
                                    <input type="hidden" name="idField" value="${right.field.idField}"/>
                                    <td>${right.farmer.username}</td>
                                    <td>${right.field.idField}</td>
                                    <td>${right.field.size}</td>
                                    <td>
                                        <input type="date" name="issueDate" value="${right.issueDate}"/>
                                    </td>
                                    <td>
                                        <input type="number" name="duration" value="${right.duration}"/>
                                    </td>
                                    <td>
                                        <input type="number" name="monthlyFee" value="${right.monthlyFee}"/>
                                    </td>
                                    <td>
                                        <button type="submit" class="btn btn-default" name="update">
                                            update
                                        </button>
                                        <button type="submit" class="btn btn-danger" name="delete">
                                            delete
                                        </button>
                                    </td>
                                </form>
                            </tr>
                        </c:forEach>
                    </c:when>
                    <c:otherwise>
                        <tr>
                            <td colspan="7">No Data available</td>
                        </tr>
                    </c:otherwise>
                </c:choose>
                </tbody>
            </table>
            <div class="row margin-top">
                <div class="col-xs-4">
                    <c:if test="${page > 1}">
                        <a href="fields?page=${page - 1}&amount=${amount}">Previous page</a>
                    </c:if>
                </div>
                <div class="col-xs-4 text-center">${page}</div>
                <div class="col-xs-4 text-right">
                    <c:if test="${not empty rights && rights.size() >= amount}">
                        <a href="fields?page=${page + 1}&amount=${amount}">Next page</a>
                    </c:if>
                </div>
            </div>
        </div>
    </jsp:body>
</t:layout>